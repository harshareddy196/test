import re
import pdb
import time


from timeit import timeit

# needle = "Buyer's Order No."

# haystacks = [[{"bottom": 116, "confidence": 100, "height": 11, "left": 59, "right": 101, "top": 105, "width": 41, "word": "ORIGINAL"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 104, "right": 107, "top": 105, "width": 3, "word": "/"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 110, "right": 156, "top": 105, "width": 46, "word": "DUPLICATE"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 159, "right": 163, "top": 105, "width": 3, "word": "/"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 165, "right": 213, "top": 105, "width": 48, "word": "TRIPLICATE"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 215, "right": 220, "top": 105, "width": 4, "word": "/"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 222, "right": 249, "top": 105, "width": 26, "word": "EXTRA"}, {"bottom": 116, "confidence": 100, "height": 11, "left": 252, "right": 274, "top": 105, "width": 21, "word": "COPY"}, {"bottom": 129, "confidence": 100, "height": 11, "left": 299, "right": 317, "top": 118, "width": 17, "word": "TAX"}, {"bottom": 129, "confidence": 100, "height": 11, "left": 319, "right": 359, "top": 118, "width": 40, "word": "INVOICE"}, {"bottom": 152, "confidence": 100, "height": 11, "left": 61, "right": 88, "top": 141, "width": 26, "word": "Citrus"}, {"bottom": 152, "confidence": 100, "height": 11, "left": 92, "right": 138, "top": 141, "width": 46, "word": "Packaging"}, {"bottom": 152, "confidence": 100, "height": 11, "left": 141, "right": 183, "top": 141, "width": 41, "word": "Solutions"}, {"bottom": 152, "confidence": 100, "height": 11, "left": 186, "right": 204, "top": 141, "width": 17, "word": "Pvt."}, {"bottom": 152, "confidence": 100, "height": 11, "left": 206, "right": 224, "top": 141, "width": 17, "word": "Ltd."}, {"bottom": 166, "confidence": 100, "height": 11, "left": 61, "right": 77, "top": 155, "width": 15, "word": "Plot"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 79, "right": 94, "top": 155, "width": 14, "word": "No."}, {"bottom": 166, "confidence": 100, "height": 11, "left": 96, "right": 119, "top": 155, "width": 22, "word": "A-20,"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 121, "right": 141, "top": 155, "width": 20, "word": "Road"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 145, "right": 156, "top": 155, "width": 11, "word": "No"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 158, "right": 166, "top": 155, "width": 7, "word": "7,"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 169, "right": 185, "top": 155, "width": 15, "word": "IDA"}, {"bottom": 166, "confidence": 100, "height": 11, "left": 187, "right": 230, "top": 155, "width": 42, "word": "Kukatpally"}, {"bottom": 164, "confidence": 100, "height": 10, "left": 338, "right": 371, "top": 154, "width": 32, "word": "Invoice:"}, {"bottom": 164, "confidence": 100, "height": 10, "left": 374, "right": 387, "top": 154, "width": 13, "word": "No."}, {"bottom": 164, "confidence": 100, "height": 10, "left": 418, "right": 495, "top": 154, "width": 77, "word": "CPSPL/19-20/0403"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 61, "right": 115, "top": 168, "width": 53, "word": "Gandhinagar,"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 119, "right": 166, "top": 168, "width": 47, "word": "Hyderabad-"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 168, "right": 184, "top": 168, "width": 15, "word": "500"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 187, "right": 205, "top": 168, "width": 17, "word": "037,"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 209, "right": 252, "top": 168, "width": 43, "word": "Telangana,"}, {"bottom": 179, "confidence": 100, "height": 11, "left": 255, "right": 278, "top": 168, "width": 23, "word": "India."}, {"bottom": 177, "confidence": 100, "height": 11, "left": 338, "right": 365, "top": 166, "width": 26, "word": "Dated:"}, {"bottom": 177, "confidence": 100, "height": 11, "left": 418, "right": 466, "top": 166, "width": 48, "word": "09-07-2019"}, {"bottom": 190, "confidence": 100, "height": 11, "left": 338, "right": 367, "top": 178, "width": 29, "word": "Buyers"}, {"bottom": 190, "confidence": 100, "height": 11, "left": 371, "right": 394, "top": 178, "width": 23, "word": "Order"}, {"bottom": 190, "confidence": 100, "height": 11, "left": 396, "right": 468, "top": 178, "width": 71, "word": "No.:4000186378"}, {"bottom": 196, "confidence": 100, "height": 11, "left": 61, "right": 88, "top": 185, "width": 26, "word": "GSTN:"}, {"bottom": 196, "confidence": 100, "height": 11, "left": 91, "right": 173, "top": 185, "width": 82, "word": "36AAHCC1842Q1Z9"}, {"bottom": 203, "confidence": 100, "height": 11, "left": 338, "right": 360, "top": 192, "width": 22, "word": "Order"}, {"bottom": 203, "confidence": 100, "height": 11, "left": 364, "right": 383, "top": 192, "width": 19, "word": "Date"}, {"bottom": 203, "confidence": 100, "height": 11, "left": 385, "right": 390, "top": 192, "width": 4, "word": ":"}, {"bottom": 203, "confidence": 100, "height": 11, "left": 418, "right": 466, "top": 192, "width": 48, "word": "18-06-2019"}, {"bottom": 212, "confidence": 100, "height": 11, "left": 61, "right": 80, "top": 201, "width": 19, "word": "CIN:"}, {"bottom": 212, "confidence": 100, "height": 11, "left": 83, "right": 187, "top": 201, "width": 104, "word": "U74999TG2017PTC19387"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 338, "right": 358, "top": 204, "width": 20, "word": "Place"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 362, "right": 369, "top": 204, "width": 7, "word": "of"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 372, "right": 403, "top": 204, "width": 31, "word": "Supply:"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 418, "right": 462, "top": 204, "width": 43, "word": "Bachupally"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 464, "right": 467, "top": 204, "width": 3, "word": "-"}, {"bottom": 215, "confidence": 100, "height": 11, "left": 471, "right": 481, "top": 204, "width": 10, "word": "36"}, {"bottom": 227, "confidence": 100, "height": 10, "left": 61, "right": 96, "top": 216, "width": 34, "word": "Contact:"}, {"bottom": 227, "confidence": 100, "height": 10, "left": 100, "right": 164, "top": 216, "width": 64, "word": "040-23072288/"}, {"bottom": 227, "confidence": 100, "height": 10, "left": 166, "right": 183, "top": 216, "width": 16, "word": "+91"}, {"bottom": 227, "confidence": 100, "height": 10, "left": 186, "right": 232, "top": 216, "width": 46, "word": "808277210"}, {"bottom": 228, "confidence": 100, "height": 10, "left": 338, "right": 373, "top": 218, "width": 34, "word": "Payment"}, {"bottom": 228, "confidence": 100, "height": 10, "left": 376, "right": 404, "top": 218, "width": 28, "word": "Terms:"}, {"bottom": 228, "confidence": 100, "height": 10, "left": 418, "right": 428, "top": 218, "width": 10, "word": "60"}, {"bottom": 228, "confidence": 100, "height": 10, "left": 430, "right": 450, "top": 218, "width": 20, "word": "Days"}, {"bottom": 240, "confidence": 100, "height": 11, "left": 61, "right": 97, "top": 229, "width": 35, "word": "Website:"}, {"bottom": 240, "confidence": 100, "height": 11, "left": 100, "right": 184, "top": 229, "width": 84, "word": "www.citruspack.com"}, {"bottom": 264, "confidence": 100, "height": 11, "left": 59, "right": 74, "top": 252, "width": 14, "word": "Bill"}, {"bottom": 264, "confidence": 100, "height": 11, "left": 77, "right": 86, "top": 252, "width": 8, "word": "to"}, {"bottom": 264, "confidence": 100, "height": 11, "left": 88, "right": 128, "top": 252, "width": 39, "word": "Receiver"}, {"bottom": 264, "confidence": 100, "height": 11, "left": 338, "right": 375, "top": 252, "width": 37, "word": "Delivery"}, {"bottom": 264, "confidence": 100, "height": 11, "left": 378, "right": 439, "top": 252, "width": 60, "word": "at/Consignee"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 59, "right": 103, "top": 265, "width": 43, "word": "Dr.Reddys"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 105, "right": 156, "top": 265, "width": 50, "word": "Laboratories"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 159, "right": 174, "top": 265, "width": 14, "word": "Ltd."}, {"bottom": 276, "confidence": 100, "height": 11, "left": 338, "right": 378, "top": 265, "width": 40, "word": "Dr.Reddys"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 382, "right": 431, "top": 265, "width": 49, "word": "Laboratories"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 435, "right": 450, "top": 265, "width": 15, "word": "Ltd."}, {"bottom": 276, "confidence": 100, "height": 11, "left": 453, "right": 469, "top": 265, "width": 16, "word": "FTO"}, {"bottom": 276, "confidence": 100, "height": 11, "left": 472, "right": 496, "top": 265, "width": 24, "word": "unit-3"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 59, "right": 95, "top": 278, "width": 35, "word": "8-2-337,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 98, "right": 119, "top": 278, "width": 20, "word": "Road"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 122, "right": 143, "top": 278, "width": 21, "word": "No.3,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 147, "right": 177, "top": 278, "width": 30, "word": "Banjara"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 181, "right": 201, "top": 278, "width": 20, "word": "Hills,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 203, "right": 285, "top": 278, "width": 82, "word": "Hyderabad-500034."}, {"bottom": 288, "confidence": 100, "height": 10, "left": 338, "right": 348, "top": 278, "width": 10, "word": "Sy"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 350, "right": 365, "top": 278, "width": 14, "word": "No."}, {"bottom": 288, "confidence": 100, "height": 10, "left": 367, "right": 381, "top": 278, "width": 13, "word": "41,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 383, "right": 430, "top": 278, "width": 47, "word": "Bachupally,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 432, "right": 476, "top": 278, "width": 43, "word": "Bachupally"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 480, "right": 511, "top": 278, "width": 31, "word": "Mandal,"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 514, "right": 547, "top": 278, "width": 32, "word": "Medchal"}, {"bottom": 288, "confidence": 100, "height": 10, "left": 550, "right": 590, "top": 278, "width": 39, "word": "Malkajgiri"}, {"bottom": 299, "confidence": 100, "height": 10, "left": 59, "right": 104, "top": 288, "width": 44, "word": "Telangana."}, {"bottom": 299, "confidence": 100, "height": 10, "left": 338, "right": 396, "top": 288, "width": 58, "word": "distric-500090"}, {"bottom": 312, "confidence": 100, "height": 11, "left": 59, "right": 140, "top": 301, "width": 80, "word": "36AAACD7999Q1ZL"}, {"bottom": 312, "confidence": 100, "height": 11, "left": 338, "right": 419, "top": 301, "width": 80, "word": "36AAACD7999Q1ZL"}, {"bottom": 330, "confidence": 100, "height": 13, "left": 516, "right": 536, "top": 317, "width": 20, "word": "GST"}, {"bottom": 330, "confidence": 100, "height": 13, "left": 566, "right": 595, "top": 317, "width": 29, "word": "Taxble"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 57, "right": 82, "top": 322, "width": 24, "word": "Sl.No"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 121, "right": 175, "top": 322, "width": 53, "word": "Description"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 178, "right": 187, "top": 322, "width": 8, "word": "of"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 191, "right": 220, "top": 322, "width": 29, "word": "Goods"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 270, "right": 315, "top": 322, "width": 44, "word": "HSN/SAC"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 339, "right": 357, "top": 322, "width": 17, "word": "Part"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 360, "right": 377, "top": 322, "width": 16, "word": "No."}, {"bottom": 335, "confidence": 100, "height": 12, "left": 408, "right": 424, "top": 322, "width": 16, "word": "Qty"}, {"bottom": 335, "confidence": 100, "height": 12, "left": 447, "right": 494, "top": 322, "width": 47, "word": "Rate(INR)"}, {"bottom": 340, "confidence": 100, "height": 13, "left": 505, "right": 546, "top": 327, "width": 40, "word": "Rate(%)"}, {"bottom": 340, "confidence": 100, "height": 13, "left": 555, "right": 607, "top": 327, "width": 51, "word": "Value(INR)"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 86, "right": 103, "top": 338, "width": 16, "word": "LBL"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 106, "right": 161, "top": 338, "width": 55, "word": "Ziprasidone"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 165, "right": 179, "top": 338, "width": 14, "word": "Hcl"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 183, "right": 201, "top": 338, "width": 17, "word": "Cap"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 204, "right": 231, "top": 338, "width": 26, "word": "80mg"}, {"bottom": 350, "confidence": 100, "height": 12, "left": 234, "right": 254, "top": 338, "width": 19, "word": "60s"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 66, "right": 71, "top": 342, "width": 5, "word": "1"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 269, "right": 317, "top": 342, "width": 47, "word": "48211020"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 331, "right": 385, "top": 342, "width": 53, "word": "150068059"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 401, "right": 431, "top": 342, "width": 30, "word": "18900"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 459, "right": 481, "top": 342, "width": 21, "word": "0.65"}, {"bottom": 356, "confidence": 100, "height": 13, "left": 558, "right": 603, "top": 342, "width": 44, "word": "12285.00"}, {"bottom": 360, "confidence": 100, "height": 12, "left": 86, "right": 105, "top": 348, "width": 19, "word": "USA"}, {"bottom": 360, "confidence": 100, "height": 12, "left": 109, "right": 122, "top": 348, "width": 13, "word": "R6"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 86, "right": 92, "top": 359, "width": 5, "word": "1"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 95, "right": 113, "top": 359, "width": 17, "word": "C/B"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 116, "right": 122, "top": 359, "width": 5, "word": "X"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 125, "right": 138, "top": 359, "width": 12, "word": "4R"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 141, "right": 148, "top": 359, "width": 6, "word": "X"}, {"bottom": 372, "confidence": 100, "height": 12, "left": 151, "right": 175, "top": 359, "width": 23, "word": "3000"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 86, "right": 92, "top": 369, "width": 5, "word": "1"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 95, "right": 113, "top": 369, "width": 17, "word": "C/B"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 116, "right": 122, "top": 369, "width": 5, "word": "X"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 125, "right": 138, "top": 369, "width": 12, "word": "4R"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 141, "right": 148, "top": 369, "width": 6, "word": "X"}, {"bottom": 382, "confidence": 100, "height": 12, "left": 151, "right": 175, "top": 369, "width": 23, "word": "1725"}, {"bottom": 402, "confidence": 100, "height": 12, "left": 86, "right": 115, "top": 390, "width": 29, "word": "TOTAL"}, {"bottom": 402, "confidence": 100, "height": 12, "left": 119, "right": 131, "top": 390, "width": 12, "word": "02"}, {"bottom": 402, "confidence": 100, "height": 12, "left": 134, "right": 167, "top": 390, "width": 32, "word": "BOXES"}, {"bottom": 412, "confidence": 100, "height": 12, "left": 225, "right": 251, "top": 400, "width": 25, "word": "CGST"}, {"bottom": 412, "confidence": 100, "height": 12, "left": 522, "right": 529, "top": 400, "width": 6, "word": "9"}, {"bottom": 412, "confidence": 100, "height": 12, "left": 562, "right": 601, "top": 400, "width": 39, "word": "1105.65"}, {"bottom": 422, "confidence": 100, "height": 12, "left": 225, "right": 251, "top": 410, "width": 25, "word": "SGST"}, {"bottom": 422, "confidence": 100, "height": 12, "left": 522, "right": 529, "top": 410, "width": 6, "word": "9"}, {"bottom": 422, "confidence": 100, "height": 12, "left": 562, "right": 601, "top": 410, "width": 39, "word": "1105.65"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 56, "right": 78, "top": 428, "width": 22, "word": "Total"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 82, "right": 115, "top": 428, "width": 33, "word": "Invoice"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 118, "right": 143, "top": 428, "width": 25, "word": "Value"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 146, "right": 155, "top": 428, "width": 8, "word": "in"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 158, "right": 186, "top": 428, "width": 28, "word": "Words"}, {"bottom": 439, "confidence": 100, "height": 11, "left": 190, "right": 193, "top": 428, "width": 3, "word": ":"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 56, "right": 96, "top": 438, "width": 40, "word": "Fourteen"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 100, "right": 143, "top": 438, "width": 43, "word": "Thousand"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 146, "right": 167, "top": 438, "width": 21, "word": "Four"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 169, "right": 209, "top": 438, "width": 39, "word": "Hundred"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 211, "right": 228, "top": 438, "width": 16, "word": "and"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 231, "right": 260, "top": 438, "width": 29, "word": "Ninety"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 264, "right": 277, "top": 438, "width": 13, "word": "Six"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 281, "right": 313, "top": 438, "width": 32, "word": "Rupees"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 317, "right": 333, "top": 438, "width": 16, "word": "and"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 336, "right": 387, "top": 438, "width": 51, "word": "ThirtyPaisa"}, {"bottom": 448, "confidence": 100, "height": 11, "left": 480, "right": 516, "top": 437, "width": 35, "word": "INVOICE"}, {"bottom": 448, "confidence": 100, "height": 11, "left": 518, "right": 548, "top": 437, "width": 30, "word": "VALUE:"}, {"bottom": 449, "confidence": 100, "height": 11, "left": 570, "right": 609, "top": 438, "width": 39, "word": "14496.30"}, {"bottom": 459, "confidence": 100, "height": 11, "left": 56, "right": 75, "top": 448, "width": 19, "word": "only"}, {"bottom": 469, "confidence": 100, "height": 10, "left": 56, "right": 75, "top": 459, "width": 19, "word": "Total"}, {"bottom": 469, "confidence": 100, "height": 10, "left": 78, "right": 109, "top": 459, "width": 30, "word": "Taxable"}, {"bottom": 469, "confidence": 100, "height": 10, "left": 111, "right": 133, "top": 459, "width": 22, "word": "Value"}, {"bottom": 469, "confidence": 100, "height": 10, "left": 570, "right": 609, "top": 459, "width": 39, "word": "12285.00"}, {"bottom": 481, "confidence": 100, "height": 11, "left": 56, "right": 75, "top": 469, "width": 19, "word": "Total"}, {"bottom": 481, "confidence": 100, "height": 11, "left": 78, "right": 100, "top": 469, "width": 21, "word": "CGST"}, {"bottom": 481, "confidence": 100, "height": 11, "left": 575, "right": 609, "top": 469, "width": 33, "word": "1105.65"}, {"bottom": 492, "confidence": 100, "height": 11, "left": 56, "right": 75, "top": 481, "width": 19, "word": "Total"}, {"bottom": 492, "confidence": 100, "height": 11, "left": 78, "right": 100, "top": 481, "width": 21, "word": "SGST"}, {"bottom": 492, "confidence": 100, "height": 11, "left": 575, "right": 609, "top": 481, "width": 33, "word": "1105.65"}, {"bottom": 502, "confidence": 100, "height": 11, "left": 56, "right": 75, "top": 491, "width": 19, "word": "Total"}, {"bottom": 502, "confidence": 100, "height": 11, "left": 78, "right": 97, "top": 491, "width": 19, "word": "IGST"}, {"bottom": 502, "confidence": 100, "height": 11, "left": 591, "right": 609, "top": 491, "width": 17, "word": "0.00"}, {"bottom": 513, "confidence": 100, "height": 11, "left": 56, "right": 75, "top": 502, "width": 19, "word": "Total"}, {"bottom": 513, "confidence": 100, "height": 11, "left": 78, "right": 112, "top": 502, "width": 33, "word": "GST/Tax"}, {"bottom": 513, "confidence": 100, "height": 11, "left": 575, "right": 609, "top": 502, "width": 33, "word": "2211.30"}, {"bottom": 523, "confidence": 100, "height": 10, "left": 56, "right": 100, "top": 513, "width": 43, "word": "Companys"}, {"bottom": 523, "confidence": 100, "height": 10, "left": 103, "right": 130, "top": 513, "width": 26, "word": "GSTN:"}, {"bottom": 523, "confidence": 100, "height": 10, "left": 132, "right": 214, "top": 513, "width": 82, "word": "36AAHCC1842Q1Z9"}, {"bottom": 534, "confidence": 100, "height": 10, "left": 56, "right": 100, "top": 523, "width": 43, "word": "Companys"}, {"bottom": 534, "confidence": 100, "height": 10, "left": 103, "right": 123, "top": 523, "width": 20, "word": "PAN:"}, {"bottom": 534, "confidence": 100, "height": 10, "left": 125, "right": 182, "top": 523, "width": 56, "word": "AAHCC1842Q"}, {"bottom": 549, "confidence": 100, "height": 11, "left": 58, "right": 102, "top": 538, "width": 43, "word": "Transport"}, {"bottom": 549, "confidence": 100, "height": 11, "left": 105, "right": 137, "top": 538, "width": 31, "word": "Details"}, {"bottom": 549, "confidence": 100, "height": 11, "left": 336, "right": 364, "top": 538, "width": 28, "word": "Docket"}, {"bottom": 549, "confidence": 100, "height": 11, "left": 366, "right": 381, "top": 538, "width": 14, "word": "No."}, {"bottom": 549, "confidence": 100, "height": 11, "left": 383, "right": 390, "top": 538, "width": 6, "word": "&"}, {"bottom": 549, "confidence": 100, "height": 11, "left": 392, "right": 414, "top": 538, "width": 22, "word": "Date:"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 58, "right": 85, "top": 548, "width": 26, "word": "Carrier"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 88, "right": 112, "top": 548, "width": 23, "word": "Name"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 190, "right": 194, "top": 548, "width": 4, "word": ":"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 336, "right": 369, "top": 548, "width": 33, "word": "Delivery"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 372, "right": 391, "top": 548, "width": 19, "word": "Type"}, {"bottom": 559, "confidence": 100, "height": 11, "left": 411, "right": 414, "top": 548, "width": 3, "word": ":"}, {"bottom": 570, "confidence": 100, "height": 11, "left": 58, "right": 86, "top": 558, "width": 28, "word": "Vehicle"}, {"bottom": 570, "confidence": 100, "height": 11, "left": 89, "right": 100, "top": 558, "width": 10, "word": "No"}, {"bottom": 570, "confidence": 100, "height": 11, "left": 190, "right": 194, "top": 558, "width": 4, "word": ":"}, {"bottom": 580, "confidence": 100, "height": 11, "left": 58, "right": 79, "top": 568, "width": 21, "word": "Mode"}, {"bottom": 580, "confidence": 100, "height": 11, "left": 190, "right": 194, "top": 568, "width": 4, "word": ":"}, {"bottom": 580, "confidence": 100, "height": 11, "left": 201, "right": 211, "top": 568, "width": 10, "word": "BY"}, {"bottom": 580, "confidence": 100, "height": 11, "left": 214, "right": 238, "top": 568, "width": 23, "word": "ROAD"}, {"bottom": 598, "confidence": 100, "height": 11, "left": 58, "right": 107, "top": 586, "width": 49, "word": "Declaration:"}, {"bottom": 602, "confidence": 100, "height": 11, "left": 336, "right": 381, "top": 591, "width": 44, "word": "Companys"}, {"bottom": 602, "confidence": 100, "height": 11, "left": 383, "right": 403, "top": 591, "width": 20, "word": "Bank"}, {"bottom": 602, "confidence": 100, "height": 11, "left": 407, "right": 438, "top": 591, "width": 31, "word": "Details:"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 58, "right": 70, "top": 597, "width": 12, "word": "We"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 73, "right": 103, "top": 597, "width": 30, "word": "Declare"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 106, "right": 123, "top": 597, "width": 16, "word": "that"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 125, "right": 140, "top": 597, "width": 14, "word": "this"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 143, "right": 172, "top": 597, "width": 28, "word": "invoice"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 174, "right": 200, "top": 597, "width": 25, "word": "shows"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 202, "right": 215, "top": 597, "width": 13, "word": "the"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 218, "right": 242, "top": 597, "width": 24, "word": "actual"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 246, "right": 265, "top": 597, "width": 19, "word": "price"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 268, "right": 276, "top": 597, "width": 7, "word": "of"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 278, "right": 292, "top": 597, "width": 13, "word": "the"}, {"bottom": 608, "confidence": 100, "height": 11, "left": 294, "right": 319, "top": 597, "width": 24, "word": "goods"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 336, "right": 356, "top": 601, "width": 20, "word": "Bank"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 359, "right": 386, "top": 601, "width": 26, "word": "Name:"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 437, "right": 458, "top": 601, "width": 21, "word": "State"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 462, "right": 482, "top": 601, "width": 20, "word": "Bank"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 484, "right": 492, "top": 601, "width": 7, "word": "of"}, {"bottom": 612, "confidence": 100, "height": 11, "left": 495, "right": 516, "top": 601, "width": 20, "word": "India"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 58, "right": 96, "top": 607, "width": 38, "word": "described"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 100, "right": 114, "top": 607, "width": 14, "word": "and"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 118, "right": 133, "top": 607, "width": 15, "word": "that"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 137, "right": 146, "top": 607, "width": 8, "word": "all"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 149, "right": 192, "top": 607, "width": 42, "word": "particulars"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 194, "right": 207, "top": 607, "width": 13, "word": "are"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 210, "right": 227, "top": 607, "width": 16, "word": "true"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 230, "right": 245, "top": 607, "width": 14, "word": "and"}, {"bottom": 618, "confidence": 100, "height": 11, "left": 248, "right": 278, "top": 607, "width": 30, "word": "correct."}, {"bottom": 622, "confidence": 100, "height": 11, "left": 336, "right": 349, "top": 611, "width": 13, "word": "A/c"}, {"bottom": 622, "confidence": 100, "height": 11, "left": 351, "right": 369, "top": 611, "width": 17, "word": "No.:"}, {"bottom": 622, "confidence": 100, "height": 11, "left": 437, "right": 510, "top": 611, "width": 73, "word": "37165719069_CA"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 58, "right": 82, "top": 617, "width": 23, "word": "Terms"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 85, "right": 91, "top": 617, "width": 5, "word": "&"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 94, "right": 137, "top": 617, "width": 42, "word": "Conditions"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 139, "right": 142, "top": 617, "width": 3, "word": ":"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 146, "right": 161, "top": 617, "width": 15, "word": "Any"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 164, "right": 219, "top": 617, "width": 55, "word": "discrepancies"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 221, "right": 248, "top": 617, "width": 26, "word": "should"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 250, "right": 260, "top": 617, "width": 10, "word": "be"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 264, "right": 295, "top": 617, "width": 31, "word": "brought"}, {"bottom": 628, "confidence": 100, "height": 11, "left": 299, "right": 306, "top": 617, "width": 7, "word": "to"}, {"bottom": 632, "confidence": 100, "height": 11, "left": 336, "right": 367, "top": 621, "width": 31, "word": "Branch:"}, {"bottom": 632, "confidence": 100, "height": 11, "left": 437, "right": 453, "top": 621, "width": 15, "word": "City"}, {"bottom": 632, "confidence": 100, "height": 11, "left": 456, "right": 505, "top": 621, "width": 49, "word": "Center(Hyd)"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 58, "right": 82, "top": 627, "width": 23, "word": "notice"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 85, "right": 110, "top": 627, "width": 24, "word": "within"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 112, "right": 118, "top": 627, "width": 5, "word": "6"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 120, "right": 140, "top": 627, "width": 20, "word": "clear"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 142, "right": 175, "top": 627, "width": 32, "word": "working"}, {"bottom": 638, "confidence": 100, "height": 11, "left": 177, "right": 200, "top": 627, "width": 22, "word": "days."}, {"bottom": 643, "confidence": 100, "height": 11, "left": 336, "right": 349, "top": 631, "width": 13, "word": "IFS"}, {"bottom": 643, "confidence": 100, "height": 11, "left": 353, "right": 376, "top": 631, "width": 23, "word": "Code:"}, {"bottom": 643, "confidence": 100, "height": 11, "left": 437, "right": 493, "top": 631, "width": 56, "word": "SBIN0013270"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 58, "right": 88, "top": 637, "width": 30, "word": "Subject"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 91, "right": 100, "top": 637, "width": 8, "word": "to"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 102, "right": 146, "top": 637, "width": 43, "word": "Hyderabad"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 149, "right": 194, "top": 637, "width": 44, "word": "Jurisdiction"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 197, "right": 202, "top": 637, "width": 4, "word": "E"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 205, "right": 211, "top": 637, "width": 5, "word": "&"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 214, "right": 220, "top": 637, "width": 5, "word": "O"}, {"bottom": 648, "confidence": 100, "height": 11, "left": 223, "right": 228, "top": 637, "width": 4, "word": "E"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 56, "right": 106, "top": 672, "width": 50, "word": "Customers"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 110, "right": 129, "top": 672, "width": 19, "word": "Seal"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 134, "right": 151, "top": 672, "width": 16, "word": "and"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 154, "right": 199, "top": 672, "width": 44, "word": "Signature"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 405, "right": 418, "top": 672, "width": 12, "word": "for"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 421, "right": 448, "top": 672, "width": 26, "word": "Citrus"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 450, "right": 498, "top": 672, "width": 47, "word": "Packaging"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 500, "right": 543, "top": 672, "width": 42, "word": "Solutions"}, {"bottom": 683, "confidence": 100, "height": 11, "left": 545, "right": 563, "top": 672, "width": 17, "word": "Pvt."}, {"bottom": 683, "confidence": 100, "height": 11, "left": 566, "right": 583, "top": 672, "width": 16, "word": "Ltd."}, {"bottom": 716, "confidence": 100, "height": 11, "left": 482, "right": 526, "top": 704, "width": 43, "word": "Authorised"}, {"bottom": 716, "confidence": 100, "height": 11, "left": 528, "right": 567, "top": 704, "width": 39, "word": "Signatory"}]]


def remove_all_except_al_num(text):
    return re.sub('[^A-Za-z0-9\s]', '', text.lower())


def sort_ocr(data):
    data = sorted(data, key = lambda i: i['top'])
    for i in range(len(data)-1):
        data[i]['word'] = data[i]['word'].strip()
        data[i+1]['word'] = data[i+1]['word'].strip()
        if abs(data[i]['top'] - data[i+1]['top']) <6 :
            data[i+1]['top'] = data[i]['top']
    data = sorted(data, key = lambda i: (i['top'], i['left']))
    return data

def convert_ocrs_to_char_dict_only_al_num(raw_haystack):
    char_index_list = []
    haystack = []

    # real_haystack_list = []
    for  hay in raw_haystack:
        for straw in hay['word']:
            temp = {}
            temp['char'] = straw.lower()
            temp.update(hay) 

            haystack.append(temp['char'])
            char_index_list.append(temp)
            # real_haystack_list.append(temp)
        char_index_list.append({})
        haystack.append(' ')
    # temp_kw = re.sub('\s{2,}', ' ', ''.join(haystack))
    # print(f'TEMP KW: {temp_kw}')
    return char_index_list, ''.join(haystack)


def find(needle, haystack):
    last_found = -1

    while True:
        last_found = haystack.find(needle, last_found+1)
        if last_found == -1:
            break
        yield last_found

def merge_coord(prev, nex):
    if prev['top'] > nex['top']:
        prev['top'] = nex['top']

    if prev['left'] > nex['left']:
        prev['left'] = nex['left']

    if prev['right'] < nex['right']:
        prev['right'] = nex['right']

    if prev['bottom'] < nex['bottom']:
        prev['bottom'] = nex['bottom']

    return prev


def make_keyword_string(keyword):
    to_return = []
    for key, value in keyword.items():
        temp_key = remove_all_except_al_num(key)
        if temp_key == (''.join(value)).lower():
            to_return.append(key)

    return to_return

def take_highest_length(keyword_sets, matches):
    max_len = 0
    for keyword_set in keyword_sets:
        temp = 0
        for key, value in keyword_set.items():
            temp+= len(value)
        if temp> max_len:
            max_len = temp

    match_return = []
    to_return = []
    for idx, keyword_set in enumerate(keyword_sets):
        temp = 0
        for key, value in keyword_set.items():
            temp+= len(value)
        if temp == max_len:
            to_return.append(keyword_set)
            match_return.append(matches[idx])

    return to_return, match_return


def make_char_coord(characs):
    keyword_set = {}
    char_coord = {'top':10000, 'left':10000, 'right':0, 'bottom':0}

    for char in characs:
        char_coord = merge_coord(char_coord, char)
        if char['word'] in keyword_set:
            keyword_set[char['word']].append(char['char'])
        else:
            keyword_set[char['word']] = [char['char']]

    return char_coord, keyword_set


def string_match_python(needle, char_index_list, haystack):
    """
    Author : Akshat Goyal

    Args:
        needle
        char_index_list
        haystack

    Return:

    """   
    matches = []
    keyword_sets = []

    needle_len = len(needle)

    len_haystack = len(haystack)

    indexes = []

    # pdb.set_trace()
    if needle in haystack:
        needle_indexes = list(find( needle, haystack))

        for index in needle_indexes:
            start = index
            end = index + needle_len
            match, keyword_set = make_char_coord(char_index_list[start:end])

            indexes.append([start, end])
            matches.append(match)
            keyword_sets.append(keyword_set)

        
    return matches, keyword_sets, indexes

# char_index_list, haystack = convert_ocrs_to_char_dict_only_al_num(haystacks[0])


# print('string_match python - ', timeit(lambda : string_match_python(needle, char_index_list, haystack), number = 1000000))

# print(convert_ocr_diff, find_needle_diff, pretty_plz_diff)